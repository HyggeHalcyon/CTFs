#!/bin/bash

# compile and assemble the exploit
cd ../exploit
make
cd ../helper 
mv ../exploit/exploit .
gzip exploit
base64 exploit.gz > exploit.gz.b64

# clearing .out
rm transfer.out

# compress exploit
for line in $(cat exploit.gz.b64); do
        echo "echo $line >> exploit.gz.b64" >> transfer.out
done

# decompress and run exploit
echo "cat exploit.gz.b64 | base64 -d > exploit.gz; gzip -d exploit.gz; chmod +x exploit; ./exploit" >> transfer.out

rm exploit.gz && rm exploit.gz.b64 