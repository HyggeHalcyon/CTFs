from pwn import *

ENC = [0xD2,0x95,0xC2,0x70,0xA4,0x53,0xD5,0x4A,0x3D,0xC0,0x9A,0x3C,0x62,0x0D,0xA7,0x41,0xEA,0x2A,0x3C,0x85,0x73,0xC6,0xAC,0x47,0xEE,0x87,0x0D,0x64,0xB8,0x5E,0xA9,0x5A,0x0D,0x47,0x8D,0x3B,0x8A,0x58,0x8A,0x00,0x05,0xDA,0x81,0x44,0xAB,0x2E,0x96,0x93,0x6E,0x43,0x56,0x1B,0x9D,0x51,0x89,0x60,0x29,0xAE,0x09,0x54,0x4E,0x7F,0xD3,0xC0,0x82,0xE8,0x0D,0xA3,0x33,0x52,0xAC,0x20,0xBD]
FLAG = []
PREFIX = b'pwndbg'

context.log_level = 'info'
def main():
    io = process(['gdb-pwndbg', '-q', 'newcomer'])

    io.sendlineafter(PREFIX, b'break *0x21f139')
    io.sendlineafter(PREFIX, b'run')
    io.sendlineafter(PREFIX, b'A'*len(ENC))

    for i in range(len(ENC)):
        io.recvuntil(b'RCX')
        al = io.recvline()[-3:-1]
        key = int(al, 16)

        FLAG.append( chr(key ^ ENC[i]) )
        print(''.join(FLAG))
        io.sendlineafter(PREFIX, b'continue')

    io.close()

if __name__ == '__main__':
    main()